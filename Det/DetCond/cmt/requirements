# $Id: requirements,v 1.74 2007-09-04 07:19:32 cattanem Exp $
# =============================================================================
package       DetCond
version       v11r6

# =========== structure =======================================================
branches      DetCond doc cmt src

# =========== dependencies ====================================================
use           GaudiKernel       v*
use           COOL              v*      LCG_Interfaces
use           CORAL             v*      LCG_Interfaces
use           Boost             v*      LCG_Interfaces
use           SEAL              v*      LCG_Interfaces
use           rx                v*      LCG_Interfaces
use           DetDesc           v*      Det

# This one is for the interface ICondDBInfo
use           LHCbKernel        v*      Kernel

# This to get the right version of Python for merge_files.py
private
use           Python              v*      LCG_Interfaces
end_private

# =========== own includes ====================================================
apply_pattern	install_more_includes more=DetCond

#==============================================================================
# Needed to resolve references to CoolApplication
apply_tag   NEEDS_COOL_FACTORY
apply_tag   NEEDS_CORAL_BASE

# =============== LCG Dictionary ==============================================
apply_pattern     reflex_dictionary                                     \
                  dictionary=DetCond                                    \
                  headerfiles=$(DETCONDROOT)/src/dict/DetCondDict.h     \
                  selectionfile=$(DETCONDROOT)/src/dict/DetCondDict.xml \
                  options="-U__MINGW32__"

# Hack for windows to workaround bug in cmt v1r19
macro DetCondDict_use_linkopts " $(Reflex_linkopts)" \
                         WIN32 " $(use_linkopts)"

# =========== constituents =====================================================
library       DetCondLib        Lib/*.cpp
library       DetCond           component/*.cpp

# =========== standard patterns (the order is essential!) ====================== 
apply_pattern component_library library=DetCond 
apply_pattern linker_library    library=DetCondLib 

# Disable some optimizations in libstdc++ (if set)
# It is needed because it seems that on SLC3 there are problems with
# multithreaded applications.
set GLIBCPP_FORCE_NEW "" \
	slc3 "1"

private

macro_append DetCond_use_linkopts $(Boost_linkopts_thread)


#macro_append DetCond_use_linkopts $(Boost_linkopts_filesystem)
# This is needed because the library used with $(Boost_linkopts_filesystem)
# is the non multithread one.
macro_append DetCond_use_linkopts ' -lboost_filesystem-gcc-mt ' \
                           Darwin ' -lboost_filesystem-$(Boost_file_version) ' \
                           WIN32  ' boost_filesystem-vc71-mt-$(Boost_file_version).lib '

