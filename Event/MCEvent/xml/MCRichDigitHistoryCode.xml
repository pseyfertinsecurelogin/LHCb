<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE gdd SYSTEM "gdd.dtd">
<gdd>
<package name="MCEvent">

<!-- **************************************************************************
  * $Id: MCRichDigitHistoryCode.xml,v 1.6 2006-03-01 09:38:42 jonrob Exp $
  *****************************************************************************
  * XML-description of MCRichDigitHistoryCode class                           *
  * author: Chris Jones   Christopher.Rob.Jones@cern.ch                       *
  * date:   2004-06-23                                                        *
  ************************************************************************* -->

<class 
        name             = "MCRichDigitHistoryCode"
        author           = "Chris Jones   Christopher.Rob.Jones@cern.ch" 
        desc             = "Bit-packed history code object for RICH data objects" >
        
        <constructor 
                desc     = "Constructor from bit-packed integer" 
                initList = "m_historyCode(code)" >
                <arg const="TRUE"  inout="BYVALUE" name="code"   type="unsigned int" />
                <code/>
        </constructor>

        <method 
                name  = "setFlags"
                const = "FALSE" 
                desc  = "set the flags according the the given history code" 
                type  = "void" >
                <arg const="TRUE" inout="BYVALUE" name="history" type="LHCb::MCRichDigitHistoryCode"/>
                <code>
                   m_historyCode = ( m_historyCode | history.historyCode() ) ;
                </code>
        </method>

        <attribute 
                name = "historyCode"
                desc = "Bit-packed history information" 
                init = "0" 
                type = "bitfield">

                <bitfield desc="Digit is associated to a signal event MCRichHit"    length="1"  name="signalEvent" />
                <bitfield desc="Digit is associated to a Prev event MCRichHit"      length="1"  name="prevEvent" />
                <bitfield desc="Digit is associated to a PrevPrev event MCRichHit"  length="1"  name="prevPrevEvent" />
                <bitfield desc="Digit is associated to a Next event MCRichHit"      length="1"  name="nextEvent" />
                <bitfield desc="Digit is associated to a NextNext event MCRichHit"  length="1"  name="nextNextEvent" />

                <bitfield desc="One of the contributing hits came from aerogel Cherenkov radiation" length="1"  name="aerogelHit" />
                <bitfield desc="One of the contributing hits came from C4F10 Cherenkov radiation"   length="1"  name="c4f10Hit" />
                <bitfield desc="One of the contributing hits came from CF4 Cherenkov radiation"     length="1"  name="cf4Hit" />

                <bitfield desc="One of the contributing hits underwent rayleigh scattering"                                                length="1" name="scatteredHit" />
                <bitfield desc="One of the contributing hits came from a charged track hitting the HPD window"                             length="1" name="chargedTrack" />
                <bitfield desc="One of the contributing hits came from CK radiation from charged tracks traversing the Gas quartz windows" length="1" name="gasQuartzCK"  />
                <bitfield desc="One of the contributing hits came from CK radiation from charged tracks traversing the HPD quartz windows" length="1" name="hpdQuartzCK"  />
                <bitfield desc="One of the contributing hits came from CK radiation from charged tracks traversing the nitrogen gas"       length="1" name="nitrogenCK"   />
                <bitfield desc="One of the contributing hits came from CK radiation from the aerogel filter"                               length="1" name="aeroFilterCK" />
                <bitfield desc="One of the contributing hits came from a dark hit (I.e. a red photon)"                                     length="1" name="darkHit"      />
                <bitfield desc="This digit was produced due to charge sharing in the HPD silicon pixel chip"                               length="1" name="chargeShareHit" />
        </attribute>

        <method 
                name  = "isBackground"
                const = "TRUE" 
                desc  = "Returns true if this digit is only due to background. I.e. none of the contributing hits were signal hits" 
                type  = "bool" >
                <code>
    return ( chargeShareHit() || 
           ( !aerogelHit() &amp;&amp;
             !c4f10Hit() &amp;&amp;
             !cf4Hit() &amp;&amp;
             ( scatteredHit() ||
               chargedTrack() ||
               gasQuartzCK() ||
               hpdQuartzCK() ||
               nitrogenCK() ||
               aeroFilterCK() ||
               darkHit()
               ) ) );
                </code>
        </method>

        <method 
                name  = "hasBackground"
                const = "TRUE" 
                desc  = "Returns true if at least one of the hits contributing to this digit came from a background source" 
                type  = "bool" >
                <code>
    return ( chargeShareHit() || scatteredHit() ||
             chargedTrack() || gasQuartzCK() ||
             hpdQuartzCK() || nitrogenCK() || aeroFilterCK() ||
             darkHit()
           );
                </code>
        </method>

        <method 
                name  = "isSignal"
                const = "TRUE" 
                desc  = "Returns true if at least one of the hits contributing to this digit came from unscattered Cherenkov radiation from one of the main RICH radiators" 
                type  = "bool" >
                <code>
    return ( ( aerogelHit() || c4f10Hit() || cf4Hit() ) &amp;&amp; !scatteredHit() );
                </code>
        </method>

</class>

</package>
</gdd>
