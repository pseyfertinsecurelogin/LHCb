<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE gdd SYSTEM "gdd.dtd" >

<gdd>

  <package name="RecEvent">
<!-- ****************************************************************
     * ProtoParticle                                                *
     ****************************************************************-->

     <class
      author = "Patrick Koppenburg, Chris Jones"
      desc   = "ProtoParticle, precursor of Particles. It holds information relative to final/global reconstruction, mostly pointers to all elements used to make it"
      name   = "ProtoParticle"
      id     = "803"
     >

       <base name="KeyedObject&lt;int&gt;"/>
       &KeyedObject;

       <import name="Kernel/ParticleID" soft="TRUE"/>
       <import name="Event/CaloHypo" soft="TRUE"/>
       <import name="GaudiKernel/VectorMap"/>
       <import name="Event/Track"/>
       <import name="Event/RichPID" soft="TRUE"/>
       <import name="Event/MuonPID" soft="TRUE"/>

       <typedef
        type   = "GaudiUtils::VectorMap&lt;int,double&gt;"
        def    = "ExtraInfo"
        desc   = "Vector of additional information"
        access = "PUBLIC"
       />

       <enum
        desc="Additional information assigned to this ProtoParticle. A combination of the PID information from the RICH, CALO, MUON and VELO systems together with any additional user information"
        name="additionalInfo"
        value="NoPID=0, RichDLLe=100, RichDLLmu=101, RichDLLpi=102, RichDLLk=103, RichDLLp=104, RichPIDStatus=105, MuonMuLL=200, MuonBkgLL=201, MuonNShared=202, MuonPIDStatus=203, InAccSpd   = 300, InAccPrs  = 301, InAccEcal= 302, InAccHcal= 303, InAccBrem= 304 , CaloTrMatch= 310, CaloElectronMatch= 311, CaloBremMatch= 312 , CaloDepositID=320, ShowerShape=321, ClusterMass=322, CaloSpdE=330,CaloPrsE=331,CaloEcalE=332,CaloHcalE=333,CaloEcalChi2=334,CaloBremChi2=335,CaloClusChi2=336,EcalPIDe=360, PrsPIDe=361, BremPIDe=362, HcalPIDe=363, HcalPIDmu=364, EcalPIDmu=365, PhotonID=380, VeloCharge=400, TrackChi2PerDof=500, TrackNumDof=501, TrackType=502, TrackHistory=503, CombDLLe=600, CombDLLmu=601, CombDLLpi=602, CombDLLk=603, CombDLLp=604, LastGlobal=10000"
        access="PUBLIC"
       />

       <location
        name="Charged"
        place="Rec/ProtoP/Charged"
       />
       <location
        name="Upstream"
        place="Rec/ProtoP/Upstream"
       />
       <location
        name="Neutrals"
        place="Rec/ProtoP/Neutrals"
       />

       <!--constructor
        argList="ProtoParticle orig"
        desc="Copy constructor, note that the original SmartRef are not cloned"
       /-->

       <!--method
        name="clone"
        desc="Clone, note that the original SmartRef are not cloned"
        type="ProtoParticle*"
        const="TRUE"
       /-->

       <!--method
        desc="Assignment operator, note that the original SmartRef are all kept"
        name="operator="
        type="ProtoParticle&amp;"
       >
         <arg name="orig" type="ProtoParticle" const='TRUE'/>
       </method-->

       <relation
        name="calo"
        desc="References to possible calorimeter results"
        multiplicity="N"
        type="LHCb::CaloHypo"       
       />

       <relation
        name="track"
        desc="Reference to possible track used"
        type="LHCb::Track"
       />

       <relation
        name="richPID"
        desc="Reference to possible RichPID result"
        type="LHCb::RichPID"
       />

       <relation
        name="muonPID"
        desc="Reference to possible MuonPID result"
        type="LHCb::MuonPID"
       />

       <attribute
        name="extraInfo"
        desc="Additional particle ID and user information. Do not access directly, use *Info() methods instead."
        type="ExtraInfo"
        setMeth="FALSE"
        getMeth="TRUE"
       />

       <method
        name    = "hasInfo"
        const   = "TRUE"
        desc    = "Does this protoparticle have information for the specified key"
        argList = "const int key"
        type    = "bool"
       />

       <method
        name    = "addInfo"
        desc    = "Add or replace new information, associated with the specified key"
        argList = "const int key, const double info"
        type    = "bool"
       />

       <method
        name    = "info"
        desc    = "Extract the information associated with the specified key. If there is no such information the default value will be returned."
        argList = "const int key, const double def"
        type    = "double"
        const   = "TRUE"
       />

       <method
        name    = "eraseInfo"
        desc    = "Erase the information associated with the specified key"
        argList = "const int key"
        type    = "ProtoParticle::ExtraInfo::size_type"
       />

       <method
        name    = "charge"
        desc    = "Returns the measured particle charge"
        type    = "int"
        const   = "TRUE" >
        <code>
         return ( track() != NULL ? track()->charge() : 0 );
        </code>
       </method>

        <method 
          name    = "fillStream" 
          desc    = "Print this ProtoParticle in a human readable way"
          type    = "std::ostream&amp;" 
          virtual = "FALSE" 
          const   = "TRUE">
          <arg 
            type = "std::ostream" 
            name = "s"/>
        </method>

    </class>
  </package>
</gdd>
