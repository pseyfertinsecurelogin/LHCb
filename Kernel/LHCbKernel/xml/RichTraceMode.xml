<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE gdd SYSTEM "gdd.dtd">
<gdd>

<!-- **************************************************************************
  * $Id: RichTraceMode.xml,v 1.2 2006-08-09 14:03:30 jonrob Exp $
  *****************************************************************************
  * XML-description of RichTraceMode class                                      *
  * author: Chris Jones   Christopher.Rob.Jones@cern.ch                       *
  * date:   2004-06-23                                                        *
  ************************************************************************* -->

  <package name='LHCbKernel'>
     <class 
        name             = "RichTraceMode"
        author           = "Chris Jones   Christopher.Rob.Jones@cern.ch" 
        desc             = "Helper class used to configure the ray tracing options in the IRichRayTracing tools"
        virtual          = "FALSE" >

        <enum name="DetectorPrecision" desc="Flag the precision mode to use when calculating the HPD acceptance on the HPD panels. Only applies if DetectorPlaneBoundary enum is set to RespectHPDTubes" access="PUBLIC" >
          <enumval name="SimpleHPDs" value="0"  desc="Approximate the HPD window acceptance by circles (fast)"/>
          <enumval name="FullHPDs"   value="1"  desc="Use the full detector description for the HPDs (slower)"/>
        </enum>

        <enum name="DetectorPlaneBoundary" desc="Flag how to treat the HPD panel and HPD tube acceptances when performing the ray tracing" access="PUBLIC" >
          <enumval name="IgnoreHPDAcceptance" value="0"  desc="Ignore the HPDs acceptance entirely (both the average HPD panel and individual tubes)"/>
          <enumval name="RespectHPDPanel"     value="1"  desc="Respect the average physical boundaries of the HPDs on the panel plane"/>
          <enumval name="RespectHPDTubes"     value="2"  desc="Respect the individual HPD acceptances"/>
        </enum>

        <constructor 
                 desc     = "Default Constructor" 
                 initList = "m_data(0)" >
                <code>
                  setDetPlaneBound     ( LHCb::RichTraceMode::IgnoreHPDAcceptance );
                  setDetPrecision      ( LHCb::RichTraceMode::SimpleHPDs          );
                </code>
        </constructor>

        <constructor 
                desc     = "Constructor with configuration values" 
                explicit = "TRUE"
                initList = "m_data(0)" >
                <arg const="TRUE" name="bound"                                     inout="BYVALUE" type="LHCb::RichTraceMode::DetectorPlaneBoundary" />
                <arg const="TRUE" name="detPrec = LHCb::RichTraceMode::SimpleHPDs" inout="BYVALUE" type="LHCb::RichTraceMode::DetectorPrecision" />
                <arg const="TRUE" name="forcedSide = false"                        inout="BYVALUE" type="bool" />
                <arg const="TRUE" name="respectOuter = false"                      inout="BYVALUE" type="bool" />
                <arg const="TRUE" name="respectMirrSegs = false"                   inout="BYVALUE" type="bool" />
                <code>
                  setDetPlaneBound     ( bound           );
                  setDetPrecision      ( detPrec         );
                  setForcedSide        ( forcedSide      );
                  setOutMirrorBoundary ( respectOuter    );
                  setMirrorSegBoundary ( respectMirrSegs );
                </code>
        </constructor>

        <attribute 
           desc = "Bit packed field containing the ray tracing configuration options" 
           name = "data" 
           init = "0"
           type = "bitfield" >
           <bitfield desc="The HPD modelling precision to use"     length="3" name="detPrecision"   type="LHCb::RichTraceMode::DetectorPrecision" />
           <bitfield desc="The HPD tube and panel acceptance mode" length="3" name="detPlaneBound"  type="LHCb::RichTraceMode::DetectorPlaneBoundary" />
           <bitfield desc="Flag to force the side to use in the ray-tracing"            length="1" name="forcedSide" />
           <bitfield desc="Flag to respect the overall outer boundaries of the mirrors" length="1" name="outMirrorBoundary" />
           <bitfield desc="Flag to respect the individual mirror segment boundaries (i.e. the small gaps between them)" length="1" name="mirrorSegBoundary" />
        </attribute>

        <method 
          name    = "fillStream" 
          desc    = "Print this RichTraceMode in a human readable way"
          type    = "std::ostream&amp;" 
          virtual = "FALSE" 
          const   = "TRUE">
          <arg 
            type = "std::ostream" 
            name = "os"/>
        </method>

    </class>
  </package>
</gdd>
