#============================================================================
# Created    : 19/04/2006
# Maintainer : Juan Palacios
#============================================================================

package LHCbMath
version           v3r24

#============================================================================
# Structure, i.e. directories to process. 
#============================================================================

branches cmt doc LHCbMath src dict python tests 

#============================================================================
# Used packages
#============================================================================
use GaudiKernel     v*
use ROOT            v*      LCG_Interfaces
use Boost           v*      LCG_Interfaces
use GSL             v*      LCG_Interfaces
use GaudiPython     v*                     -no_auto_imports

apply_pattern install_more_includes more=LHCbMath

apply_pattern install_python_modules

macro_append ROOT_linkopts " -lMathCore -lGenVector " \
                     WIN32 " libMathCore.lib libGenVector.lib "

# ================= constituents: linker library ============================
library                     LHCbMathLib    ../src/*.cpp
                        
application  TestPow     ../tests/pow.cpp         
macro_append TestPow_dependencies      " LHCbMathLib "
application  TestBit     ../tests/bit.cpp          
macro_append TestBit_dependencies      " LHCbMathLib "
application  TestDigit   ../tests/digit.cpp       
macro_append TestDigit_dependencies    " LHCbMathLib "
application  TestKine    ../tests/kinematics.cpp   
macro_append TestKine_dependencies     " LHCbMathLib "
application  TestLomont  ../tests/TestLomontCompare.cpp 
macro_append TestLomont_dependencies   " LHCbMathLib "
application  TestErrors  ../tests/withErrors.cpp 
macro_append TestErrors_dependencies   " LHCbMathLib "
application  TestRound  ../tests/TestRound.cpp 
macro_append TestRound_dependencies    " LHCbMathLib "
application  TestLomont2 ../tests/TestLomontCPU.cpp 
macro_append TestLomont2_dependencies   " LHCbMathLib "
application  TestEigen   ../tests/TestEigen.cpp 
macro_append TestEigen_dependencies   " LHCbMathLib "
application  TestBlind   ../tests/blind.cpp 
macro_append TestBlind_dependencies   " LHCbMathLib "
application  TestAbs      ../tests/testAbs.cpp 
macro_append TestAbs_dependencies   " LHCbMathLib "
        
# ================= patterns ================================================
apply_pattern       linker_library library=LHCbMathLib
#============================================================================
apply_pattern reflex_dictionary                               \
              dictionary=LHCbMath                                 \
              headerfiles=$(LHCBMATHROOT)/dict/LHCbMathDict.h         \
              selectionfile=$(LHCBMATHROOT)/dict/LHCbMathDict.xml     \
              options="-U__MINGW32__"
#============================================================================

macro_append LHCbMathDict_dependencies   " LHCbMathLib "
# Disable some compiler remarks in the automatically generated dict code
macro_append LHCbMathDict_cppflags "" \
                        target-icc " -wd177 -wd1572 -wd2259"

macro        LHCbMath_use_linkopts $(use_linkopts)

#============================================================================
private
# Note: libgslcblas is needed by libgsl, but the link is missing.
macro_prepend GSL_linkopts " -Wl,--no-as-needed " \
                    Darwin "" \
                     WIN32 ""
macro_append  GSL_linkopts " -Wl,--as-needed " \
                    Darwin "" \
                     WIN32 "" \
                target-icc ""
end_private
