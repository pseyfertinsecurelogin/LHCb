!-----------------------------------------------------------------------------
! Package     : Kernel/LHCbAlgs
! Responsible : Marco Cattaneo
! Purpose     : General purpose algorithms and tools for LHCb
!-----------------------------------------------------------------------------

!======================== LHCbAlgs v2r35 2010-09-27 ==========================
! 2010-09-24 - Marco Clemencic
 - Added forgotten dependency on Event/RecEvent

! 2010-09-23 - Marco Clemencic
 - Added an implementation of IEventTimeDecoder (TimeDecoderList) that uses a
   list of IEventTimeDecoder instances (returning the first non-zero time
   found).
 - Added RecEventTime, an implementation of IEventTimeDecoder that takes the
   event time from LHCb::RecHeader.

!======================== LHCbAlgs v2r34p1 2010-05-21 ========================
! 2010-05-18 - Marco Cattaneo
 - Fix Windows warnings

!======================== LHCbAlgs v2r34 2010-03-17 ==========================
! 2010-03-02 - Marco Clemencic
 - Added check of the Magic Pattern in the ODIN bank decoding
   (ODINCodecBaseTool::i_decode).

! 2010-03-01 - Gerhard Raven
 - optimize DeterministicPrescaler a bit more...

!======================== LHCbAlgs v2r33 2010-02-12 ==========================
! 2010-02-12 - Gloria CORTI
 - Add file containing declaration of LbAppInit factory to allow instanciating
   it directly. It was in LHCbAlgs_dll.cpp that was removed because obsolete.

! 2010-01-05 - Gerhard Raven
 - if DeterministicPrescaler accepts all events, don't print out an Info()
   level messages stating this

!======================== LHCbAlgs v2r32 2010-01-20 ==========================
! 2009-12-28 - Wouter Hulsbergen
 - Protect TrajPoca against piecewisetraj returning '0' for distToErr

!======================== LHCbAlgs v2r31p1 2009-12-11 ========================
! 2009-12-07 - Marco Cattaneo
 - Fix trivial untested StatusCode in MemoryTool.cpp

!======================== LHCbAlgs v2r31 2009-11-21 ==========================
! 2009-11-21 - Marco Clemencic
 - Fixed a problem in the decoding and encoding of the event time in the ODIN
   bank version 6.

!======================== LHCbAlgs v2r30 2009-11-13 ==========================
! 2009-11-09 - Marco Clemencic
 - Moved the tool properties from ODINCodecBaseTool to ODINEncodeTool and
   ODINDecodeTool for higher flexibility.

! 2009-11-07 - Marco Cattaneo
 - Fix Windows compilation error in ODINCodecBaseTool

! 2009-11-06 - Chris Jones
 - Add trivial algorithm that allows for sequence filtering based on the
   version of DataObjects. Allows for use cases like the re-creation of some
   data depending on its version.

! 2009-11-06 - Marco Clemencic
 - Modified the ODINCodecBaseTool to look for the RawEvent bank in more than one
   place, always including LHCb::RawEventLocation::Copied, LHCb::RawEventLocation::Default.
   The decoding has been modified to use the new definition of the trigger types
   ODIN class (which now is only transient).

!======================== LHCbAlgs v2r29p1 2009-10-22 ========================
! 2009-10-22 - Marco Clemencic
 - Modified the ODINCodecBaseTool to accept ODIN bank version 6 (no change in
   the actual decoding).

!======================== LHCbAlgs v2r29 2009-10-16 ==========================
! 2009-10-08 - Marco Cattaneo
 - In TESCheck, do not call Warning() if OutputLevel is greater than WARNING

! 2009-10-08 - Vanya Belyaev
 - Memory Tool:
    1. two new conunters:
       "Total Memory/MB"
       "Delta Memory/MB"
    2. two new histograms
       "Total Memory [MB]"
       "Delta Memory [MB]"

! 2009-09-14 - Rob Lambert
 - Fixed compiler warnings in EventCountAlg

! 2009-09-09 - Rob Lambert
 - Added EventCountAlg, which has a nameable counter()
   This will presumably replace EventCountHisto with the
   XMLSummarySvc for most users.

!======================== LHCbAlgs v2r28 2009-07-13 ==========================
! 2009-07-13 - Marco Cattaneo
 - Remove obsolete file LHCbAlgs_dll.cpp

! 2009-07-09 - Marco Clemencic
 - Renamed the values (enum) for the beam crossing type in the ODIN class from
   Left/Right to 1/2.
   Requires Event/DAQEvent > v7r21.

!======================== LHCbAlgs v2r27 2009-06-16 ==========================
! 2009-06-14 - Gerhard Raven
 - reduce functionality of DeterministicPrescaler to the strictly needed
   in order to speed it up furhter...

!======================== LHCbAlgs v2r26 2009-05-07 ==========================
! 2009-05-01 - Gerhard Raven
 - speed up DeterministicPrescaler

! 2009-04-15 - Patrick Koppenburg
 - AlgorithmCorrelations : check for duplicate entries

! 2009-04-06 - Olivier Deschamps
 - OdinTimeDecoder : make the tool ODINDecodeTool private

! 2009-03-17 - Marco Cattaneo
 - Fix TESCheck.cpp for Gaudi v21 (backward compatible)
 - Replace all endreq (deprecated) by endmsg

!======================== LHCbAlgs v2r25 2009-03-10 ==========================
! 2009-03-09 - Jeroen van Tilburg
 - Added FilterByBankType algorithm. Can be used to select events based
   on which banks are present in the RawEvent.

!======================== LHCbAlgs v2r24 2009-02-19 ==========================
! 2009-02-19 - Marco Cattaneo
 - Fix Windows compilation error and warnings

! 2009-02-11 - Rob Lambert
 - added EventCountHisto.{h,cpp} an algorithm which adds a histogram with
   one entry, which is the number of events seen by this algorithm.

! 2009-02-11 - Marco Cattaneo
 - Protect against eccessive warnings in TrajPoca.cpp

! 2009-02-05 - Marco Clemencic
 - Relaxed the check on the ODIN bank size for version < 3 to take into account
   an old bug in BooleInit.

! 2009-02-04 - Marco Clemencic
 - Using the extended RunChangeIncident (DetDesc) in OdinTimeDecoder to pass
   the run number.

! 2009-02-03 - Marco Clemencic
 - Added OdinTimeDecoder, RunChangeTest, TestTimeDecoderOdin and corresponding
   tests. (were in Event/DAQEvent)
 - Added the tools ODINDecodeTool and ODINEncodeTool, both inheriting from
   ODINCodecBaseTool, which contains the implementation of the ODIN -> RawBank
   and RawBank -> ODIN functions. Added a test too (lhcbalgs.odin_codec).
 - Added dependencies on Det/DetDesc to compile RunChangeTest, and to
   Det/DetDescSvc and Det/DetCond for the tests.

!======================== LHCbAlgs v2r23 2009-01-09 ==========================
! 2009-01-09 - Patrick Koppenburg
 - TESCheck : issue setFilterPassed(false) when location is not found in
   Stop = false mode.

! 2008-12-29 - Gerhard Raven
 - DeterminsticPrescaler: replace custom statistics with StatEntity

! 2008-12-09 - Patrick Spradlin
 - Added doxygen comments to FilterByRunEvent

!======================== LHCbAlgs v2r22 2008-11-17 ==========================
! 2008-11-13 - Marco Cattaneo
 - Fix untested StatusCode in EventNodeKiller

! 2008-11-04 - Patrick Koppenburg
 - Protect debug() in DeterministicPrescaler

! 2008-10-30 - Marco Cattaneo
 - More fixes gcc 4.3 compilation, and fix an uninitialised property

! 2008-10-29 - Patrick Koppenburg
 - AlgorithmCorrelations :
   . Fix compilation warning from gcc 4.3
   . Remove all references to SelResult

!======================== LHCbAlgs v2r21 2008-09-04 ==========================
! 2008-08-17 Gerhard Raven
 - make sure DeterministicPrescaler does not crash on events without ODIN

!======================== LHCbAlgs v2r20 2008-07-21 ==========================
! 2008-07-21 - Marco Cattaneo
 - Adapt to new locations of IEventTimeDecoder and IGenericTool interfaces
   (needs Gaudi v20r2)

!======================== LHCbAlgs v2r19 2008-07-08 ==========================
! 2008-07-08 - Marco Cattaneo
 - In FPEAuditor, move exception in case of no implementation to initialize
   (previously in constructor) otherwise genconf fails on platforms where
   FPEGuard is not implemented

! 2008-06-10 - Gerhard Raven
 - Move FPEGuard.h to LHCbKernel

! 2008-06-10 - Chris Jones
 - Add method FPE::Guard::mask_type mask( const std::string & excpt )
 - Final improvements to doxygen comments

! 2008-06-10 - Gerhard Raven
 - FPE::Guard: take into account that the FPU might not yet have completed
   its transition when checking for restoration of the initial state. Add
   an explicit 'fwait' in that case, and check again.

! 2008-06-09 - Chris Jones
 - Improve doxygen comments in FPE code + add a simple constructor

! 2008-06-09 - Gerhard Raven
 - more improvements to FPEAuditor:
   o fix chicken-and-egg problem when auditing initialize: 'after'
     will get called for the IAuditerSvc implementation without 'before'
   o split FPEGuard in dedicated header, to be moved 'upstream'
   o put platform specific code in the FPE::details namespace,
     renamve FPEGuard into FPE::Guard.
   o add doxygen comments to FPE::Guard.
   o change in behaviour: when using the Auditor on a platform without
     support, it will throw an exception. However, when using the Guard
     on an unsupported platform, it becomes a no-op.

! 2008-06-06 - Gerhard Raven
 - general improvements to FPEAuditor:
   o  clear exception flags before switching on trapping (otherwise, any
      error generated earlier will generate a trap the moment trapping is
      switched on -- and hence produce a confusing traceback)
   o  put platform dependent code together in a single place...
   o  add "Invalid" to possible checks (oops, forgot about that one)
   o  simplify FPEGuard, deal with type differences between linux & win32

!======================== LHCbAlgs v2r18 2008-06-04 ==========================
! 2008-06-04 - Gerhard Raven
 - add option to FPEAuditor to disable trapping for specified algorithms

! 2008-06-04 - Marco Cattaneo
 - Add a windows implementation for FPEAuditor

! 2008-06-03 - Gerhard Raven
 - Add FPEAuditor, which can configure the FPU to trap a specified set of
   Floating Point Exceptions, and generate a SIGFPE (which leads to Gaudi
   providing a traceback and aborting the job)

!======================== LHCbAlgs v2r17 2008-05-20 ==========================
! 2008-05-20 - Gerhard Raven
 - Abandon dispatching on types in DeterministicPrescaler

! 2008-04-25 - Gerhard Raven
 - add rate prescaling based on run#, event#, gpsTime and algorithm instance
   name to DeterministicPrescaler
 - add some comments to FilterByRunEvent pointing out that event# is NOT a
   32 bit number -- fixing this properly requires adding a new property type.

!======================== LHCbAlgs v2r16 2008-04-16 ==========================
! 2008-04-16 - Marco Cattaneo
 - Give meaningful names to MemoryTool histograms and don't print histogram
   statistics by default

!======================== LHCbAlgs v2r15 2008-02-12 ==========================
! 2008-02-11 - Patrick Koppenburg
 - AlgorithmCorrelations : Allow to print efficiencies for conditions
   algorithms as well.

! 2008-02-05 - Patrick Koppenburg
 - AlgorithmCorrelations : More functionality. And allow non-square matrices
   (did not work previously)

!======================== LHCbAlgs v2r14 2008-02-02 ==========================
! 2008-01-30 - Patrick Koppenburg
 - AlgorithmCorrelations : Protect debug() and verbose()

! 2008-01-15 - Marco Cattaneo
 - Add createODIN algorithm, to create DAQ/ODIN object from ODIN RawBank

!======================== LHCbAlgs v2r13 2007-11-28 ==========================
! 2007-11-28 - Marco Cattaneo
 - Reimplemented FilterByRunEvent using property type std::vector<std::pair> >
   Now, run/event number pairs are defined with the following syntax:
   FilterByRunEvent.RunEventNumList = { (182001,1), (182001,3), (182001,5) };
 - Fix an untested StatusCode

! 2007-11-24 V Gligorov
 - Added FilterByRunEvent{.ccp,.h}, for Patrick Spradlin.

! 2007-11-19 M Needham
 - Fix a comparision of == with double

!======================== LHCbAlgs v2r12 2007-10-12 ==========================
! 2007-10-12 - Wouter Hulsbergen
 - changes in TrajPoca
   . adapted to interface change in trajectory
   . fixed bug in specification of tolerance for validity of quadratic
     approximation

!======================== LHCbAlgs v2r11 2007-10-11 ==========================
! 2007-10-11 - Marco Cattaneo
 - Rename EventCounter tool to EvtCounter, to avoid clash with GaudiAlg class
   of same name

! 2007-10-10 - Wouter Hulsbergen
 - TrajPoca: Added a line that was by mistake removed when this was imported from
   babar: previous version just didn't work for non-linear trajectories.

!======================== LHCbAlgs v2r10 2007-07-05 ==========================
! 2007-07-05 - Patrick Koppenburg
 - PrintHeader: print header in info(). Avoids other useless printout
   in debug().
 - Increment to v2r10

!======================== LHCbAlgs v2r9 2007-06-04 ===========================
! 2007-06-04 - Marco Cattaneo
 - Adapt to Gaudi v19r4 change of setFilterPassed return type

! 2007-05-31 - Marco Cattaneo
 - ProcessPhase "MeasureTime" property now defaults to GaudiSequencer default
   (false)

!======================== LHCbAlgs v2r8 2007-05-10 =======================
! 2007-05-10 - Patrick Koppenburg
 - Fix untested StatusCodes

!======================== LHCbAlgs v2r7 2007-03-19 =======================
! 2007-03-19 - Marco Cattaneo
 - Fix untested StatusCodes

!======================== LHCbAlgs v2r6 2007-03-07 =======================
! 2007-03-07 - Patrick Koppenburg
 - DeterminiticPrescaler: print out event-by-event message in debug only

! 2007-03-01 - Marco Cattaneo
 - Add general purpose components previously in Tools/Utilities:
   AlgorithmCorrelations, DeterministicPrescaler, PostScaler, PrintHeader
   Also EventCounter (previouly called EventNumber)
 - Add dependency on DAQEvent (for ODIN bank definition)

! 2007-02-26 - Marco Cattaneo
 - Add LbAppInit factory declaration to LHCbAlgs_dll.cpp, to avoid having it
   in LHCbKernel link library (and all .rootmaps of packages using LHCbKernel)
 - Remove obsolete LHCbAlgs_load.cpp file
 - Remove LHCBDefinitions includes

!======================== LHCbAlgs v2r5 2006-11-30 =======================
! 2006-11-30 - Edwin Bos
 - Fixed the return StatusCode of TrajPoca

!======================== LHCbAlgs v2r4 2006-09-04 =======================
! 2006-09-04 - Marco Cattaneo
 - Adapt to changed interface of addPropertyToCatalogue in Gaudi v18r7

!======================== LHCbAlgs v2r3 2006-07-31 =======================
! 2006-07-31 - Marco Cattaneo
 - Fix memory leak in ProcessPhase initialization, due to changed behaviour
   of addPropertyToCatalogue (Gaudi Savannah bug #18581)

!======================== LHCbAlgs v2r2 2006-07-18 =======================
! 2006-07-18 - Marco Cattaneo
 - Change string handling in ProcessPhase initialization, to comply with
   new job options service

!======================== LHCbAlgs v2r1 2006-06-30 =======================
!2006-06-29 M Needham
 - Add poca tool here - was in TrackTools

!======================== LHCbAlgs v2r0 2006-03-09 =======================
! 2006-03-09 - Marco Cattaneo
 - Fix uninitialized variable in MemoryTool
 - Remove obsolete InitRndmTool, use methods in LbAppInit base class instead

! 2005-12-14 - Marco Cattaneo
 - Remove LbAppInit. Replaced by two tools: InitRndmTool, MemoryTool

!======================== LHCbAlgs v1r9 2005-09-06 =======================
! 2005-09-06 - Marco Cattaneo
 - Remove dependency on LHCbInterfaces and pick up Kernel/INormalizeTool.h from
   it new location in LHCbKernel

!======================== LHCbAlgs v1r8 2005-07-15 =======================
! 2005-07-15 - Marco Cattaneo
 - Add EventNodeKiller algorithm to kill nodes in the event data store. Useful if
   you want to make the application "forget" about the previous history of the

!======================== LHCbAlgs v1r7 2005-06-23 =======================
! 2005-06-23 - Marco Cattaneo
 - LbAppInit is now a GaudiHistoAlg, property "HistoProduce" replaces "doHistos"
 - Split memory histogram into two, both with "HistoSize" bins
   . hID=2: one entry per event for first HistoSize events
   . hID=3: one entry every HistoSize events, starting at event 1

!======================== LHCbAlgs v1r6 2005-05-03 =======================
! 2005-05-03 - Marco Cattaneo
 - Remove TESFilter algorithm, moved to EventUtils

!======================== LHCbAlgs v1r5 2005-04-19 =======================
! 2005-04-19 - Marco Cattaneo
 - Remove printout of program name and version, now done in ApplicationMgr

!======================== LHCbAlgs v1r4 2005-03-18 =======================
! 2005-03-18 - Marco Cattaneo
 - Add "PreloadGeometry" option to LbAppInit. Default is false

!======================= LHCbAlgs v1r3p1 2005-01-28 =======================
! 2005-01-28 - Marco Cattaneo
 - Remove an unnecessary variable from LbAppInit
 - Fix some doxygen warnings

!======================== LHCbAlgs v1r3 2004-11-30 ========================
! 2004-11-30 - Marco Cattaneo
 - LbAppInit:
   . Replace SmartDataPtr access to ProcStatus, use GaudiAlgorithms methods

!======================== LHCbAlgs v1r2 2004-11-11 ========================
! 2004-11-11 - Marco Cattaneo
 - LbAppInit:
   . Remove use of timing tool at initilisation, as normalisation of timing is
     now done in SequencerTimerTool
   . Improve initialisation of random numbers: now the run and event number are
     given as first and second seeds to setSeeds, as well as being used in the
     hash algorithm to generate a third seed. The previous behaviour can be
     recovered by seting the "SingleSeed" option to true. In addition, one can
     skip some random numbers before every event, set by the "SkipFactor" job
     option (default value = 0)

!======================= LHCbAlgs v1r1p1 2004-10-26 =======================
! 2004-10-26 - Marco Cattaneo
 - LbAppInit: bug fix, if creating the event header, it contained the run number
              instead of the event number, and 0 for the run number

!======================== LHCbAlgs v1r1 2004-09-06 ========================
! 2004-09-17 - Marco Cattaneo
 - Add TESCheck algorithm from Vanya, to preload and/or check existence of
   objects in the transient store

! 2004-09-06 - Marco Cattaneo
 - LbAppInit: Protect against undefined APPVERSION environment variable

! 2004-07-30 - P. Koppenburg
 - LbAppInit: Print memory usage at each event in debug() OutputLevel

!======================== LHCbAlgs v1r0 2004-07-21 ========================
! 2004-07-21 - Marco Cattaneo
 - First version:
 . TimingTool:   provides a timing normalization       (previously in LHCbTools)
 . ProcessPhase: phase for data processing application (previously in LHCbKernel)
 . TESFilter:    removes selected data from TES        (previously in BrunelAlgs)
 . LbAppInit:    common initialisation algorithm for Gauss,Boole,Brunel
 . (StoreExplorer algorithm, available in a pre-release version of this
    package, has been removed, use instead StoreExplorerAlg from GaudiSvc)
